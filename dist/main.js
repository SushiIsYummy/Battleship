(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var r=e.g.document;if(!t&&r&&(r.currentScript&&(t=r.currentScript.src),!t)){var a=r.getElementsByTagName("script");if(a.length)for(var l=a.length-1;l>-1&&!t;)t=a[l--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=function(e,t){let r=0,a=[];return{name:e,length:t,hit(){r++},resetHits(){r=0},isSunk(){return r>=this.length},getPositions:()=>JSON.parse(JSON.stringify(a)),addPosition(e,t){a.length>=this.length||a.push({row:e,col:t})}}},r=[{name:"carrier",length:5,orientation:null,row:null,col:null},{name:"battleship",length:4,orientation:null,row:null,col:null},{name:"cruiser",length:3,orientation:null,row:null,col:null},{name:"submarine",length:3,orientation:null,row:null,col:null},{name:"destroyer",length:2,orientation:null,row:null,col:null}];const a=function(){let e=10,a=Array(e).fill().map((()=>Array(e).fill(null))),l=Array(e).fill().map((()=>Array(e).fill(!1))),n=[];return{receiveAttack(e,t){if(!1!==l[e][t])return;let r=a[e][t];null!==r?(r.hit(),l[e][t]="hit"):l[e][t]="miss"},placeShip(t,r){if(function(t){const{length:r,row:l,col:n,orientation:o}=t;if("horizontal"===o&&n+r>e||"vertical"===o&&l+r>e)return!1;if("horizontal"===o){for(let e=0;e<r;e++)if(null!=a[l][n+e])return!1}else if("vertical"===o)for(let e=0;e<r;e++)if(null!=a[l+e][n])return!1;return!0}(r)){const{row:e,col:l,name:o,length:i,orientation:s}=r;if("horizontal"===s)for(let r=0;r<i;r++)a[e][l+r]=t,t.addPosition(e,l+r);else if("vertical"===s)for(let r=0;r<i;r++)a[e+r][l]=t,t.addPosition(e+r,l);return n.push(t),!0}return!1},placeShipsRandomly(){r.forEach((e=>{let r=t(e.name,e.length),a={...e};do{let e=Math.floor(Math.random()*(this.getSize()-0)+0),t=Math.floor(Math.random()*(this.getSize()-0)+0),r=Math.round(Math.random())?"horizontal":"vertical";a.row=e,a.col=t,a.orientation=r}while(!0!==this.placeShip(r,a))}))},allShipsSunk(){for(let e=0;e<n.length;e++)if(!n[e].isSunk())return!1;return!0},getSize:()=>e,getBoard:()=>a,clearBoard(){for(let t=0;t<e;t++)for(let r=0;r<e;r++)a[t][r]=null},getBoardHits:()=>JSON.parse(JSON.stringify(l)),resetBoardHits(){for(let t=0;t<e;t++)for(let r=0;r<e;r++)l[t][r]=!1},getShips:()=>[...n],removeAllShips(){n=[]},cellHitInfo:(e,t)=>l[e][t],displayBoard(){console.table(a)}}};const l=function(e,t,r){let a=e.getSize(),l=document.querySelector(`.${t}`);for(let e=0;e<a;e++)for(let t=0;t<a;t++){let a=document.createElement("div");a.classList.add("cell"),a.classList.add(r),a.dataset.row=e,a.dataset.col=t,l.appendChild(a)}};const n=function(e,t){const r=document.querySelector(`.${t}`),a=e.getSize(),l=e.getBoard();for(let e=0;e<a;e++)for(let t=0;t<a;t++){let a=l[e][t];if(null!==a){r.querySelector(`.cell[data-row="${e}"][data-col="${t}"]`).dataset.shipName=a.name}}};const o=function(e,t,r,a,l){let n=e.cellHitInfo(r,a),o=document.querySelector(`.${t}`).querySelector(`.cell[data-row="${r}"][data-col="${a}"]`);if(!1!==n){let e=function(){let e=20;const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width",`${e}`),t.setAttribute("height",`${e}`),t.classList.add("hit-marker");const r=document.createElementNS("http://www.w3.org/2000/svg","circle");return r.setAttribute("cx",""+e/2),r.setAttribute("cy",""+e/2),r.setAttribute("r",""+e/2),t.appendChild(r),t}();e.classList.add(l),o.appendChild(e)}};const i=function(e){let t=Array(e.getSize()).fill().map((()=>Array(e.getSize()).fill(!0)));return{gameboard:e,attack(e,r,a){if(this.hasAvailableHit(r,a)){return e.gameboard.receiveAttack(r,a),t[r][a]=!1,!0}return!1},hasAvailableHit:(e,r)=>t[e][r],getRemainingAvailableHits(){let e=[];for(let r=0;r<t.length;r++)for(let a=0;a<t.length;a++)this.hasAvailableHit(r,a)&&e.push({row:r,col:a});return e},resetAvailableHits(){let e=this.gameboard.getSize();for(let r=0;r<e;r++)for(let a=0;a<e;a++)t[r][a]=!0}}},s=e.p+"b9c69bc988aeb9bf35ca.mp3",c=e.p+"74280d6f23dc4aa34b60.mp3";function d(){let e=new Audio(s);e.volume=.2,e.play()}function u(){new Audio(c).play()}const m=function(e){document.querySelector(`.${e}`).querySelectorAll(".cell").forEach((e=>{e.hasAttribute("data-ship-name")&&delete e.dataset.shipName,e.classList.contains("hit")&&e.classList.remove("hit");let t=e.querySelector(".hit-marker");t&&t.remove()}))},y="fade-out";let h=1500,p=[];const f=a(),g=a(),b={playerBoard:f,enemyBoard:g,player:i(f),enemy:i(g),winner:null,currentPlayer:null,switchPlayer(){this.currentPlayer===this.player?this.currentPlayer=this.enemy:this.currentPlayer===this.enemy&&(this.currentPlayer=this.player)},gameOver:!1};function S(){let e=Math.round(Math.random());b.currentPlayer=b.player,0===e?(b.currentPlayer=b.player,P(".player-side .board-container")):(b.currentPlayer=b.enemy,P(".enemy-side .board-container"),p.push(setTimeout(w,h))),v("Game Start!",y),b.enemyBoard.removeAllShips(),b.enemyBoard.placeShipsRandomly(),function(){const e=document.querySelector(".enemy-board");e.addEventListener("click",B)}(),document.querySelector(".enemy-board").classList.remove("game-not-started"),document.querySelector(".start-game-button").classList.add("game-started"),document.querySelector("button.random-board-button").classList.add("game-started");let t=document.querySelector("button.reset-game-button");t.classList.add("game-started"),t.addEventListener("click",q)}function v(e,t){let r=document.querySelector(".message-info");r.textContent=e,void 0!==t&&r.classList.add(y)}function w(){let e=b.enemy.getRemainingAvailableHits(),t=Math.floor(Math.random()*e.length),{row:r,col:a}=e.splice(t,1)[0];if(b.enemy.attack(b.player,r,a),"hit"===b.playerBoard.cellHitInfo(r,a)){if(o(b.playerBoard,"player-board",r,a,"hit"),d(),A(b.enemy))return void L();p.push(setTimeout(w,h))}else"miss"===b.playerBoard.cellHitInfo(r,a)&&(u(),o(b.playerBoard,"player-board",r,a,"miss"),b.switchPlayer(),P(".player-side .board-container"),P(".enemy-side .board-container"))}function B(e){if(A(b.player))return;let t=e.target;if(t.classList.contains("enemy-cell")){let e=Number(t.dataset.row),r=Number(t.dataset.col);if(b.currentPlayer===b.player&&!b.gameOver&&b.player.hasAvailableHit(e,r))if(b.player.attack(b.enemy,e,r),t.classList.add("hit"),"hit"===b.enemyBoard.cellHitInfo(e,r)){d(),o(b.enemyBoard,"enemy-board",e,r,"hit");let t=b.enemyBoard.getBoard()[e][r];if(t.isSunk()&&function(e){let t=e.getPositions();for(let r=0;r<t.length;r++){document.querySelector(`.enemy-cell[data-row="${t[r].row}"][data-col="${t[r].col}"]`).dataset.shipName=e.name}}(t),A(b.player))return void L()}else"miss"===b.enemyBoard.cellHitInfo(e,r)&&(u(),o(b.enemyBoard,"enemy-board",e,r,"miss"),b.switchPlayer(),P(".player-side .board-container"),P(".enemy-side .board-container"),p.push(setTimeout(w,h)))}}function A(e){let t=(e===b.player?b.enemyBoard:b.playerBoard).allShipsSunk();return t&&(b.winner=e),t}function L(){document.querySelector(".enemy-board").removeEventListener("click",B),b.winner===b.player?v("You Win!"):b.winner===b.enemy&&v("You Lose!")}function q(){p.forEach((e=>{clearTimeout(e)})),p.length=0,b.winner=null,b.gameOver=!1,b.currentPlayer=null,b.playerBoard.getShips().forEach((e=>{e.resetHits()})),b.playerBoard.resetBoardHits(),b.player.resetAvailableHits(),b.enemyBoard.clearBoard(),b.enemyBoard.resetBoardHits(),b.enemy.resetAvailableHits(),m("player-board"),n(b.playerBoard,"player-board"),m("enemy-board"),document.querySelector(".enemy-board").classList.add("game-not-started"),document.querySelector(".start-game-button").classList.remove("game-started"),document.querySelector("button.random-board-button").classList.remove("game-started"),document.querySelector("button.reset-game-button").classList.remove("game-started"),document.querySelectorAll(".board-container").forEach((e=>{e.classList.remove("not-current-turn")})),H()}function H(){let e=document.querySelector(".message-info");e.textContent="Â ",e.classList.remove(y)}function P(e){let t=document.querySelector(`${e}`);t&&t.classList.toggle("not-current-turn")}!function(){document.querySelector(".random-board-button").addEventListener("click",(()=>{m("player-board"),b.playerBoard.clearBoard(),b.playerBoard.removeAllShips(),b.playerBoard.placeShipsRandomly(),n(b.playerBoard,"player-board")})),document.querySelector(".start-game-button").addEventListener("click",S);let e=document.querySelector(".message-info");e.addEventListener("animationend",(t=>{H(),e.classList.remove(y)})),l(b.playerBoard,"player-board","player-cell"),l(b.enemyBoard,"enemy-board","enemy-cell"),b.playerBoard.placeShipsRandomly(),n(b.playerBoard,"player-board")}()})();